/*1367317973,178142531*/

if (self.CavalryLogger) { CavalryLogger.start_js(["QNfTu"]); }

__d("Recaptcha",["AsyncRequest","Bootloader","CSS","DOM","Env","ge","tx","CaptchaClientConfig"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('Env'),l=b('ge'),m=b('tx'),n=b('CaptchaClientConfig'),o,p={tabindex:0,callback:null},q={widget:null,timer_id:-1,fail_timer_id:-1,type:'image',ajax_verify_cb:null,audio_only:false,$:function(r){if(typeof(r)=="string"){return document.getElementById(r);}else return r;},create:function(r,s){q.destroy();if(r)q.widget=q.$(r);q._init_options(s);q._call_challenge(n.recaptchaPublicKey);},destroy:function(){var r=q.$('recaptcha_challenge_field');if(r)r.parentNode.removeChild(r);if(q.timer_id!=-1)clearInterval(q.timer_id);q.timer_id=-1;var s=q.$('recaptcha_image');if(s)s.innerHTML="";if(q.widget){q.widget.style.display="none";q.widget=null;}},focus_response_field:function(){var r=q.$,s=r('captcha_response');try{s.focus();}catch(t){}},get_challenge:function(){if(typeof(a.RecaptchaState)=="undefined")return null;return a.RecaptchaState.challenge;},get_response:function(){var r=q.$,s=r('captcha_response');if(!s)return null;return s.value;},ajax_verify:function(r){q.ajax_verify_cb=r;var s=q._get_api_server()+"/ajaxverify"+"?c="+encodeURIComponent(q.get_challenge())+"&response="+encodeURIComponent(q.get_response());q._add_script(s);},_ajax_verify_callback:function(r){q.ajax_verify_cb(r);},_get_api_server:function(){var r=window.location.protocol,s;if(typeof(a._RecaptchaOverrideApiServer)!="undefined"){s=a._RecaptchaOverrideApiServer;}else s="www.google.com";return r+"//"+s;},_call_challenge:function(r){if(!q.audio_only)q.fail_timer_id=setTimeout(function(){if(q.fail_timer_id==-1)q.logAction('timeout');q.createCaptcha();},15000);var s=q._get_api_server()+"/recaptcha/api/challenge?k="+r+"&ajax=1&xcachestop="+Math.random();if(l('extra_challenge_params')!=null)s+="&"+l('extra_challenge_params').value;q._add_script(s);},_add_script:function(r){h.requestJSResource(r);},_init_options:function(r){var s=p,t=r||{};for(var u in t)s[u]=t[u];o=s;},challenge_callback:function(){if(!q.audio_only){clearTimeout(q.fail_timer_id);q._reset_timer();}if(window.addEventListener)window.addEventListener('unload',function(t){q.destroy();},false);if(q._is_ie()&&window.attachEvent)window.attachEvent('onbeforeunload',function(){});if(navigator.userAgent.indexOf("KHTML")>0){var r=document.createElement('iframe');r.src="about:blank";r.style.height="0px";r.style.width="0px";r.style.visibility="hidden";r.style.border="none";var s=document.createTextNode("This frame prevents back/forward cache problems in Safari.");r.appendChild(s);document.body.appendChild(r);}q._finish_widget();if(q.audio_only)q.switch_type('audio');q.logAction('shown');},_finish_widget:function(){var r=q.$,s=a.RecaptchaState,t=o,u=document.createElement("input");u.type="password";u.setAttribute("autocomplete","off");u.style.display="none";u.name="recaptcha_challenge_field";u.id="recaptcha_challenge_field";r('captcha_response').parentNode.insertBefore(u,r('captcha_response'));r('captcha_response').setAttribute("autocomplete","off");r('recaptcha_image').style.width='300px';r('recaptcha_image').style.height='57px';q.should_focus=false;if(!q.audio_only){q._set_challenge(s.challenge,'image');}else q._set_challenge(s.challenge,'audio');if(t.tabindex)r('captcha_response').tabIndex=t.tabindex;if(q.widget)q.widget.style.display='';if(t.callback)t.callback();r('recaptcha_loading').style.display="none";},switch_type:function(r){var s=q;s.type=r;s.$('recaptcha_type').value=r;s.reload(s.type=='audio'?'a':'v');},reload:function(r){var s=q,t=s.$,u=a.RecaptchaState;if(typeof(r)=="undefined")r='r';var v=u.server+"reload?c="+u.challenge+"&k="+u.site+"&reason="+r+"&type="+s.type+"&lang="+k.recaptcha_lang;if(l('extra_challenge_params')!=null)v+="&"+l('extra_challenge_params').value;s.should_focus=r!='t';s._add_script(v);},finish_reload:function(r,s){a.RecaptchaState.is_incorrect=false;q._set_challenge(r,s);},_set_challenge:function(r,s){var t=q,u=a.RecaptchaState,v=t.$;u.challenge=r;t.type=s;v('recaptcha_challenge_field').value=u.challenge;v('recaptcha_challenge_field').defaultValue=u.challenge;v('recaptcha_image').innerHtml="";if(s=='audio'){v("recaptcha_image").innerHTML=q.getAudioCaptchaHtml();}else if(s=='image'){var w=u.server+'image?c='+u.challenge;v('recaptcha_image').innerHTML="<img style='display:block;' height='57' width='300' src='"+w+"'/>";}q._css_toggle("recaptcha_had_incorrect_sol","recaptcha_nothad_incorrect_sol",u.is_incorrect);q._css_toggle("recaptcha_is_showing_audio","recaptcha_isnot_showing_audio",s=='audio');if(t.should_focus)t.focus_response_field();t._reset_timer();},_reset_timer:function(){var r=a.RecaptchaState;clearInterval(q.timer_id);q.timer_id=setInterval("Recaptcha.reload('t');",(r.timeout-60*5)*1000);},_clear_input:function(){var r=q.$('captcha_response');r.value="";},_displayerror:function(r){var s=q.$;j.empty('recaptcha_image');s('recaptcha_image').appendChild(document.createTextNode(r));},reloaderror:function(r){q._displayerror(r);},_is_ie:function(){return (navigator.userAgent.indexOf("MSIE")>0)&&!window.opera;},_css_toggle:function(r,s,t){var u=q.widget;if(!u)u=document.body;var v=u.className;v=v.replace(new RegExp("(^|\\s+)"+r+"(\\s+|$)"),' ');v=v.replace(new RegExp("(^|\\s+)"+s+"(\\s+|$)"),' ');v+=" "+(t?r:s);i.setClass(u,v);},playAgain:function(){var r=q.$;r("recaptcha_image").innerHTML=q.getAudioCaptchaHtml();},getAudioCaptchaHtml:function(){var r=q,s=a.RecaptchaState,t=q.$,u=s.server+"image?c="+s.challenge;if(u.indexOf("https://")==0)u="http://"+u.substring(8);var v=s.server+"/img/audiocaptcha.swf?v2",w;if(r._is_ie()){w='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="audiocaptcha" width="0" height="0" codebase="https://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab"><param name="movie" value="'+v+'" /><param name="quality" value="high" /><param name="bgcolor" value="#869ca7" /><param name="allowScriptAccess" value="always" /></object><br/>';}else w='<embed src="'+v+'" quality="high" bgcolor="#869ca7" width="0" height="0" name="audiocaptcha" align="middle" play="true" loop="false" quality="high" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://get.adobe.com/flashplayer" url="'+v+'"></embed> ';var x=(q.checkFlashVer()?'<br/><a class="recaptcha_audio_cant_hear_link" href="#" onclick="Recaptcha.playAgain(); return false;">'+"Riprova"+'</a>':'')+'<br/><a class="recaptcha_audio_cant_hear_link" target="_blank" href="'+u+'">'+"Non riesci a sentire l'audio?"+'</a>';return w+x;},gethttpwavurl:function(){var r=a.RecaptchaState;if(q.type=='audio'){var s=r.server+"image?c="+r.challenge;if(s.indexOf("https://")==0)s="http://"+s.substring(8);return s;}return "";},checkFlashVer:function(){var r=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false,s=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false,t=(navigator.userAgent.indexOf("Opera")!=-1)?true:false,u=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var v=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",w=navigator.plugins["Shockwave Flash"+v].description,x=w.split(" "),y=x[2].split(".");u=y[0];}}else if(r&&s&&!t)try{var aa=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),ba=aa.GetVariable("$version");u=ba.split(" ")[1].split(",")[0];}catch(z){}return u>=9;},getlang:function(){return k.recaptcha_lang;},createCaptcha:function(){var r={};if(k.recaptcha_focus_on_load)r.callback=q.focus_response_field;setTimeout(function(){q.create("captcha",r);},0);},createAudioCaptcha:function(){setTimeout(function(){q._init_options({});q.audio_only=true;q._call_challenge(n.recaptchaPublicKey);},0);},logAction:function(r){new g().setURI('/ajax/captcha/recaptcha_log_actions.php').setData({action:r,ua:navigator.userAgent,location:window.location.href}).setMethod('GET').setReadOnly(true).send();}};a.recaptcha_log_action=q.logAction;e.exports=q;a.Recaptcha=q;});
__d("JPPhoneCaptcha",["AsyncRequest","AsyncSignal","CSS","Dialog","DOM","Event","Parent","$","ge","bind","copyProperties","emptyFunction","tx"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('AsyncSignal'),i=b('CSS'),j=b('Dialog'),k=b('DOM'),l=b('Event'),m=b('Parent'),n=b('$'),o=b('ge'),p=b('bind'),q=b('copyProperties'),r=b('emptyFunction'),s=b('tx');function t(u,v,w,x,y){var z=function(){this._dom=n(u);this._hash=w;this._altCaptcha=y;var aa=o('A_btn_sign_up');aa&&i.hide(aa);var ba=k.find(this._dom,'img');ba.onerror=ba.onload=function(){if(ba.width==1&&ba.height==1)this.showAlternateCaptcha();}.bind(this);ba.src=v;l.listen(k.find(this._dom,'a.qr-skip-link'),'click',this.showAlternateCaptcha.bind(this));this.checkStatus.bind(this).defer(t.initialPoll);t._currentInstance=this;}.bind(this);if(t._overrideDelay){x=false;delete t._overrideDelay;}if(x){t._delayedCaptcha=z;}else z();}t.initialPoll=5000;t.pollInterval=2000;t.createCaptcha=function(){if(t._currentInstance){t._currentInstance._destroyed=true;t._overrideDelay=true;delete t._currentInstance;}if(t._delayedCaptcha){t._delayedCaptcha();delete t._delayedCaptcha;}};q(t.prototype,{checkStatus:function(){new g('/captcha/qr_async.php').setData({hash:this._hash}).setOption('suppressErrorHandlerWarning',true).setErrorHandler(r).setReadOnly(true).setMethod('GET').setHandler(function(u){var v=u.getPayload();if(this._destroyed)return;if(v===false){this.showAlternateCaptcha();}else if(v===true){new j().setTitle("Ci sei quasi!").setBody("Vai alla pagina successiva per completare la registrazione.").setButtons(j.CLOSE).setCloseHandler(p(this,this.proceedToNux)).show();this._destroyed=true;}}.bind(this)).setFinallyHandler(function(){!this._destroyed&&this.checkStatus.bind(this).defer(t.pollInterval);}.bind(this)).send();},proceedToNux:function(){var u=m.byTag(this._dom,'form'),v=k.scry(u,'#captcha_buttons input');if(v.length==1&&v[0].onclick){v[0].onclick();}else u.submit();this._destroyed=true;},showAlternateCaptcha:function(){t._alternateCaptchaShown=true;t._stupidGlobalFunction();k.setContent(this._dom,this._altCaptcha);this._destroyed=true;var u=o('A_btn_sign_up');u&&i.show(u);new h('/captcha/qr_async.php',{skip:true,hash:this._hash}).send();return false;}});e.exports=t;});
__d("legacy:fbdesktop-detect",["FBDesktopDetect"],function(a,b,c,d){a.FbDesktopDetect=b('FBDesktopDetect');},3);
__d("IndexLogoutSponsorship",["Event","URI","ge"],function(a,b,c,d,e,f){var g=b('Event'),h=b('URI'),i=b('ge'),j;function k(n){return setTimeout(function(){h('/index.php').addQueryData({l_s:'r'}).go();},n);}function l(n,o){var p=false,q=function(){if(p)return;clearTimeout(j);j=k(o);},r=function(){clearTimeout(j);p=true;};g.listen(document,{mousedown:r,mouseup:r,click:r,keydown:r,mousemove:q});if(n!==null){g.listen(n,'mouseover',function(){g.listen(window,'blur',r);});var s=i('email');try{s.focus();}catch(t){}}}var m={init:function(n,o){j=k(o);l(n,o);}};e.exports=m;});
__d("IntlUtils",["AsyncRequest","Cookie","goURI"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Cookie'),i=b('goURI'),j={setXmode:function(k){(new g()).setURI('/ajax/intl/save_xmode.php').setData({xmode:k}).setHandler(function(){document.location.reload();}).send();},setAmode:function(k){new g().setURI('/ajax/intl/save_xmode.php').setData({amode:k,app:false}).setHandler(function(){document.location.reload();}).send();},setLocale:function(k,l,m,n){if(!m)m=k.options[k.selectedIndex].value;j.saveLocale(m,true,null,l,n);},saveLocale:function(k,l,m,n,o){new g().setURI('/ajax/intl/save_locale.php').setData({aloc:k,source:n,app_only:o}).setHandler(function(p){if(l){document.location.reload();}else i(m);}).send();},setLocaleCookie:function(k,l){h.set('locale',k,7*24*3600000);i(l);}};e.exports=j;});
__d("legacy:intl-base",["IntlUtils"],function(a,b,c,d){var e=b('IntlUtils');a.intl_set_xmode=e.setXmode;a.intl_set_amode=e.setAmode;a.intl_set_locale=e.setLocale;a.intl_save_locale=e.saveLocale;a.intl_set_cookie_locale=e.setLocaleCookie;},3);
function FormTypeABTester(a){var b=16,c=32,d=65,e=90,f=48,g=57,h=58,i=63,j=91,k=94,l=0,m=0,n=0,o=0,p=[],q=null,r=[],s=[],t=[],u=[];for(var v=0;v<10;v++){r.push(0);s.push(0);}for(var w=0;w<10;w++){s.push(0);t.push(0);u.push(0);}var x=function(aa){var ba=window.event?Date.now():aa.timeStamp,ca=window.event?window.event.keyCode:aa.which;ca%=128;if((ca>=d&&ca<=e)||ca==c){l++;}else if(ca>=f&&ca<=g){m++;}else if(ca>=h&&ca<=i||ca>=j&&ca<=k){n++;}else o++;p[ca]=ba;if(q){var da=ba-q;if(da>=0&&((ca>=d&&ca<=e)||ca==c))if(da<400){s[Math.floor(da/20)]++;}else if(da<1000){t[Math.floor((da-400)/60)]++;}else if(da<3000)u[Math.floor((da-1000)/200)]++;}q=ba;},y=function(aa){var ba=window.event?Date.now():aa.timeStamp,ca=window.event?window.event.keyCode:aa.which,da=ba-p[ca%128];if(da>=50&&da<250)r[Math.floor((da-50)/20)]++;},z=function(aa){var ba=Math.max.apply(Math,aa),ca=[];aa.forEach(function(da){ca.push(Math.floor(da*63/(ba||1)));});return ca;};this.getDataVect=function(){var aa=s.concat(t,u);return z(aa).concat(z(r),[l/2,m/2,n/2,o/2]);};this.getData=function(){return Base64.encodeNums(this.getDataVect());};Event.listen(a,{keyup:y.bind(this),keydown:x.bind(this)});}function startFormTypeABTester(a){a.ab_tester=new FormTypeABTester(document);}function setFormTypeABTest(a){a.ab_test_data.value=a.ab_tester.getData();return true;}
__d("LoginFormController",["Event","ge","Button"],function(a,b,c,d,e,f){var g=b('Event'),h=b('ge'),i=b('Button');f.init=function(j,k){g.listen(j,'submit',function(){i.setEnabled(k,false);i.setEnabled.curry(k,true).defer(15000);});var l=h('lgnjs');if(l)l.value=parseInt(Date.now()/1000,10);};});
__d("UserStorage",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=false;try{if('localStorage' in a&&a.localStorage){a.localStorage.setItem('test',true);a.localStorage.removeItem('test');h=true;}}catch(i){}function j(k,l){this.uid=k||'';this.project=l||'';this.storage=a.localStorage;}g(j.prototype,{_disabled:false,setItem:function(k,l){this.setString(k,JSON.stringify(l));},getItem:function(k){var l=this.getString(k);return l&&JSON.parse(l);},deleteItem:function(k){delete this.storage[this._buildKey(k)];},setString:function(k,l){if(!this._disabled)this.storage[this._buildKey(k)]=l;},getString:function(k){return this.storage[this._buildKey(k)];},_buildKey:function(k){return [this.uid,this.project,k].join(':');},cleanup:function(k){k=k||false;var l=[this.uid,this.project].join(':');for(var m in this.storage){var n=this.storage.hasOwnProperty&&!this.storage.hasOwnProperty(m);if(!m||this.storage[m]===undefined||n)continue;if(!k&&!m.match(l))continue;delete this.storage[m];}},setDisabled:function(k){this._disabled=k;},isSupported:function(){return h&&this.storage!==undefined;}});e.exports=j;});
__d("LoginChooserMenu",["AsyncRequest","CSS","cx","DOM","emptyFunction","ge","$","Event","UserStorage","Toggler","URI"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('CSS'),i=b('cx'),j=b('DOM'),k=b('emptyFunction'),l=b('ge'),m=b('$'),n=b('Event'),o=b('UserStorage'),p=b('Toggler'),q=b('URI'),r='userchooserblocked',s=2592000,t='user_chooser_user_container_',u='user_chooser_user_box_',v='user_chooser_close_button_',w='login_chooser_dark_background',x='user_container_',y={setup:function(z,aa,ba,ca,da,ea,fa,ga){if(this.isDisabledOnBrowser())return;var ha=y.getValidOsessUsers();if(!z&&this.isEmpty(ha))return;this.dialogRecentLogins=ea;this.dialogRecentLoginsAttached=false;var ia=false,ja=q.getRequestURI().getQueryData().smuh;if(ja)ia=y.aretooManyRecentDeclines(ja);this.justLoggedOutNewUser=null;if(!ia){this.dialogOptIn=ga;if(fa){if(!ha[fa.id])this.justLoggedOutNewUser=fa.id;ha[fa.id]=fa;}}var ka=false;for(var la in ha){ka=true;var ma=ca.cloneNode(true),na=ha[la].id;ma.setAttribute('id',t+na);(j.scry(ma,'.'+"_4--h")[0]).setAttribute('src',ha[la].pic_url);(j.scry(ma,'.'+"_507d")[0]).appendChild(document.createTextNode(ha[la].name));var oa=(j.scry(ma,'.'+"userBox")[0]);oa.setAttribute('id',u+na);n.listen(oa,'click',this.userClicked.bind(this,oa.id));var pa=(j.scry(ma,'.'+"_27-r")[0]);pa.setAttribute('id',v+na);n.listen(pa,'click',this.handleIndexXClick.bind(this,pa.id));h.removeClass(ma,'hidden_elem');ba.appendChild(ma);}if(!ka)return;ca.parentNode.removeChild(ca);h.removeClass(aa,'hidden_elem');n.listen(da,'click',this.headerClicked.bind(this));var qa=null;if(this.dialogOptIn&&this.justLoggedOutNewUser&&!ia){qa=this.justLoggedOutNewUser;this.dialogOptIn.show();this.promoteRecentUser();var ra=l('button_chooser_optin_yes');n.listen(ra,'click',this.newUserDialogAddUser.bind(this,fa));var sa=l('button_chooser_optin_no');n.listen(sa,'click',this.newUserDialogRemoveUser.bind(this));}y.phoneHome({action:'render_chooser_index',optin_dialog_uid:qa,ctx:'index'});},headerClicked:function(){this.dialogRecentLogins.show();if(this.dialogRecentLoginsAttached)return;this.dialogRecentLoginsAttached=true;var z=l('login_chooser_contextual_dialog');n.listen((j.scry(z,'label.'+"_50am")[0]),'click',this.clearRecentLogins.bind(this));n.listen((j.scry(z,'label.'+"_50an")[0]),'click',this.disableOnBrowser.bind(this));},filterOsessUsers:function(z){var aa=Date.now()/1000-s,ba={};for(var ca in z)if(z[ca].time>aa)ba[ca]=z[ca];return ba;},phoneHome:function(z){z.osess_size=this.getDictionarySize(this.getValidOsessUsers());new g().setURI('/ajax/login/chooser').setOption("suppressErrorHandlerWarning",true).setOption("suppressErrorAlerts",true).setErrorHandler(k).setTransportErrorHandler(k).setData(z).send();},userClicked:function(z){var aa=z.slice(u.length);y.phoneHome({action:'show_login_dialog',login_uid:aa,ctx:'index'});this.unpromoteRecentUser();},attachSettingsMenuOnclicks:function(z,aa,ba){n.listen(aa,'click',function(event){p.hide(m('navAccount'));y.phoneHome({action:'show_login_dialog',login_uid:z,ctx:'settings_menu'});event.stopPropagation();});n.listen(ba,'click',function(event){y.removeUserFromLocalStorage(z);y.removeUserFromSettingsUI(z);y.phoneHome({action:'remove_user',login_uid:z,ctx:'settings_menu'});event.stopPropagation();});},handleIndexXClick:function(z){var aa=z.slice(v.length);y.removeUserFromLocalStorage(aa);y.removeUserFromIndexUI(aa);this.unpromoteRecentUser();y.phoneHome({action:'remove_user',login_uid:aa,ctx:'index'});},removeUserFromLocalStorage:function(z){var aa=new o(0,'userchooser'),ba=aa.getItem('osessusers');if(!ba)return;for(var ca in ba)if(ca==z)delete ba[ca];aa.setItem('osessusers',ba);},recordNotNowResponse:function(z){var aa=new o(0,'userchooser'),ba=aa.getItem('declines');if(this.isEmpty(ba))ba={};var ca=ba[z];if(this.isEmpty(ca))ca=[];ca.push(Date.now());if(ca.length>3)ca=ca.slice(ca.length-3);ba[z]=ca;aa.setItem('declines',ba);},aretooManyRecentDeclines:function(z){var aa=86400*7*1000,ba=new o(0,'userchooser'),ca=ba.getItem('declines');if(this.isEmpty(ca))return false;var da=ca[z];if(this.isEmpty(da))return false;var ea=Date.now(),fa=0;for(var ga=0;ga<da.length;ga++){var ha=da[ga],ia=ea-ha;if(ia<aa)fa++;}return (fa>=3);},removeUserFromIndexUI:function(z){var aa=l(t+z);aa.parentNode.removeChild(aa);var ba=j.scry(document,'div.'+"_4--g");if(!ba.length){var ca=l('login_chooser_container');h.addClass(ca,'hidden_elem');}},removeUserFromSettingsUI:function(z){var aa=l(x+z);aa.parentNode.removeChild(aa);},addUser:function(z,aa){if(this.isDisabledOnBrowser())return;var ba=new o(0,'userchooser'),ca=y.getValidOsessUsers();if(this.isEmpty(ca))ca={};ca[z]=aa;ba.setItem('osessusers',ca);},newUserDialogAddUser:function(z){y.addUser(this.justLoggedOutNewUser,z);y.phoneHome({action:'add_to_list',login_uid:this.justLoggedOutNewUser,ctx:'index'});this.dialogOptIn.hide();this.unpromoteRecentUser();},newUserDialogRemoveUser:function(){y.removeUserFromIndexUI(this.justLoggedOutNewUser);var z=q.getRequestURI().getQueryData().smuh;y.recordNotNowResponse(z);y.phoneHome({action:'dont_add',login_uid:this.justLoggedOutNewUser,ctx:'index'});this.unpromoteRecentUser();},isDisabledOnBrowser:function(){var z=(new o(0,'userchooser')).getItem('osessusers');return z&&z==r;},promoteRecentUser:function(){this.addBackgroundScreen();var z=l(t+this.justLoggedOutNewUser);h.addClass((j.scry(z,'.'+"_4--i")[0]),"_50nr");h.addClass((j.scry(z,'.'+"_507d")[0]),"_50ns");h.addClass((j.scry(z,'.'+"_27-r")[0]),"_50nr");var aa=j.scry(document.body,'.loggedout_menubar_container')[0];if(aa){h.addClass(aa,"_50nr");h.addClass(aa,"_50nt");}},unpromoteRecentUser:function(){this.removeBackgroundScreen();if(this.dialogOptIn)this.dialogOptIn.hide();var z=l(t+this.justLoggedOutNewUser);if(z){h.removeClass((j.scry(z,'.'+"_4--i")[0]),"_50nr");h.removeClass((j.scry(z,'.'+"_507d")[0]),"_50ns");h.removeClass((j.scry(z,'.'+"_27-r")[0]),"_50nr");}var aa=j.scry(document.body,'.loggedout_menubar_container')[0];if(aa){h.removeClass(aa,"_50nr");h.removeClass(aa,"_50nt");}},addBackgroundScreen:function(){var z=j.create('div',{id:w,className:"_50nu"});j.appendContent(l('login_chooser_container'),z);n.listen(z,'click',this.newUserDialogRemoveUser.bind(this));},removeBackgroundScreen:function(){if(l(w)){var z=l(w);z.parentNode.removeChild(z);}},clearRecentLogins:function(){(new o(0,'userchooser')).setItem('osessusers',{});h.addClass(l('login_chooser_container'),'hidden_elem');this.dialogRecentLogins.hide();y.phoneHome({action:'clear_list',ctx:'index'});},disableOnBrowser:function(){(new o(0,'userchooser')).setItem('osessusers',r);h.addClass(l('login_chooser_container'),'hidden_elem');this.dialogRecentLogins.hide();y.phoneHome({action:'turn_off_feature',ctx:'index'});},fetchSettingsMenu:function(z){var aa=y.getValidOsessUsers();if(this.isEmpty(aa))return;var ba=false,ca=[];for(var da in aa){if(aa[da].id==z){ba=true;continue;}ca.push(aa[da].id);}if(!ba)return;if(ca.length===0)return;var ea={osess_users:ca};new g().setURI('/ajax/login/chooser/settings_menu').setOption('suppressErrorHandlerWarning',true).setOption('suppressErrorAlerts',true).setErrorHandler(k).setTransportErrorHandler(k).setData(ea).send();},getValidOsessUsers:function(){var z=(new o(0,'userchooser')).getItem('osessusers');if(!z)return {};return this.filterOsessUsers(z);},getDictionarySize:function(z){var aa=0;for(var ba in z)if(z.hasOwnProperty(ba))aa++;return aa;},isEmpty:function(z){if(z===null)return true;if(z===undefined)return true;if(z.length&&z.length>0)return false;if(z.length===0)return true;for(var aa in z)if(z.hasOwnProperty(aa))return false;return true;}};e.exports=y;});
__d("Registration",["Animation","AsyncRequest","AsyncSignal","CSS","DataStore","DOM","Event","Form","HTML","JPPhoneCaptcha","Recaptcha","RegistrationInterstitialCaptcha","Style","$","ge","goURI"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('AsyncRequest'),i=b('AsyncSignal'),j=b('CSS'),k=b('DataStore'),l=b('DOM'),m=b('Event'),n=b('Form'),o=b('HTML'),p=b('JPPhoneCaptcha'),q=b('Recaptcha'),r=b('RegistrationInterstitialCaptcha'),s=b('Style'),t=b('$'),u=b('ge'),v=b('goURI'),w='/ajax/register/logging.php',x={init:function(y,z,aa,ba,ca,da,ea){this.captchaPaneShown=false;this.errorField=null;this.hasLoggedFocus=false;this.focusListeners=[];this.regForm=y;this.logFocusName=aa;this.validationEndpoint=ba;this.responseCallback=this.handleResponse;this.tosContainerNode=u('tos_container');this.regPagesMsgNode=u('reg_pages_msg');this.captchaButtonsNode=u('captcha_buttons');this.initListeners(ca,da,ea);this.childValidators=this.childValidators||[];this.shownFlyout=this.shownFlyout||null;},initListeners:function(y,z,aa){this.focusListeners=[m.listen(this.regForm,'click',this.logFormFocus.bind(this)),m.listen(this.regForm,'keypress',this.logFormFocus.bind(this))];m.listen(y,'click',this.validateForm.bind(this));m.listen(z,'click',this.validateForm.bind(this));m.listen(aa,'click',(function(){this.hideCaptcha();this.showRegistrationPane();}).bind(this));m.listen(window,'load',(function(){a.startFormTypeABTester(this.regForm);m.listen(y,'click',a.setFormTypeABTest.bind(this,this.regForm));m.listen(z,'click',a.setFormTypeABTest.bind(this,this.regForm));}).bind(this));},validateForm:function(){var y=n.serialize(this.regForm);if(!this.captchaPaneShown)y.ignore='captcha|pc';if(this.errorField&&u(this.errorField))t(this.errorField).setAttribute('title','');j.show('async_status');j.show('captcha_async_status');new h().setOption('jsonp',true).setURI(this.validationEndpoint).setData(y).setReadOnly(true).setHandler(this.responseCallback.bind(this)).send();},handleResponse:function(y){j.hide('async_status');j.hide('captcha_async_status');var z=y.getPayload();if(z.redirect){j.show('captcha_async_status');v(z.redirect);}else if(z.field_validation_succeeded){this.handleFieldValidationSucceeded(z);}else if(z.bad_captcha){this.handleBadCaptcha(z);}else if(z.need_pc){this.handleNeedPC(z);}else if(z.tooyoung){this.handleTooYoung(z);}else if(z.ask_to_login_instead){var aa=u('email');if(aa)aa.value=z.ask_to_login_instead;var ba=u('asked_to_login');if(ba)ba.value=1;}else if(z.registration_succeeded){this.handleRegistrationSucceeded(z);}else this.handleValidationError(z);},handleValidationError:function(y){this.showValidationError(y.field,y.error);},handleRegistrationSucceeded:function(y){var z=t('confirmation_email_form'),aa=t('confirmation_email');aa.value=y.email;z.submit();},handleBadCaptcha:function(y){l.setContent(t('outer_captcha_box'),o(y.html));this.showCaptchaPane();this.showValidationError('captcha_response',y.error);},handleNeedPC:function(y){var z=u('outer_captcha_box');if(z)l.setContent(z,o(y.html));this.showCaptchaPane();this.showValidationError('pc',y.error);},handleFieldValidationSucceeded:function(y){this.hideValidationError();this.showCaptchaPane();if(y.show_captcha_interstitial)r.show();},handleTooYoung:function(y){l.setContent(this.regForm,o(y.html));},showCaptchaPane:function(){j.hide('reg_form_box');var y=t('captcha'),z=k.get(y,'captcha-class','FacebookCaptcha');if(z=='ReCaptchaCaptcha'){q.createCaptcha();}else if(z=='JPPhoneCaptcha')p.createCaptcha();j.show('reg_captcha');this.tosContainerNode&&j.show(this.tosContainerNode);this.regPagesMsgNode&&j.hide(this.regPagesMsgNode);this.captchaButtonsNode&&j.show(this.captchaButtonsNode);try{u('captcha_response').focus();}catch(aa){}this.captchaPaneShown=true;},hideCaptcha:function(){u('reg_captcha')&&j.hide('reg_captcha');this.tosContainerNode&&j.hide(this.tosContainerNode);this.captchaButtonsNode&&j.hide(this.captchaButtonsNode);this.hideValidationError();this.captchaPaneShown=false;},showValidationError:function(y,z){this.regPagesMsgNode&&j.hide(this.regPagesMsgNode);this.hideValidationError();var aa=t('reg_error'),ba=t('reg_error_inner');if(!y)y=u('name')?'name':'firstname';this.errorField=y;try{t(y).setAttribute('title',z.replace(/<.+?>/g,''));t(y).focus();}catch(ca){}l.setContent(ba,o(z));s.set(aa,'opacity',0);new g(aa).show().to('height','auto').duration(100).checkpoint().from('opacity',0).to('opacity',1).duration(400).go();},hideValidationError:function(){if(j.shown(t('reg_error'))&&s.getOpacity(t('reg_error'))>0)j.hide(t('reg_error'));},showRegistrationPane:function(){j.show('reg_form_box');this.regPagesMsgNode&&j.show(this.regPagesMsgNode);},logFormFocus:function(){if(this.hasLoggedFocus)return;this.logAction(this.logFocusName);this.hasLoggedFocus=true;this.focusListeners.forEach(function(y){y.remove();});this.focusListeners=[];},logAction:function(y){var z=this.regForm.reg_instance&&this.regForm.reg_instance.value,aa={action:y,reg_instance:z};new i(w,aa).send();},enrollChildValidator:function(y){this.childValidators=this.childValidators||[];this.childValidators.push(y);y.emitShow=function(z){if(this.shownFlyout)this.shownFlyout.hide();z.show();this.shownFlyout=z;}.bind(this);y.emitHide=function(z){z.hide();};}};e.exports=x;});
__d("useragentcm",["Bootloader","Env","ge"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('Env'),i=b('ge');function j(){var k=false,l={ffid:(typeof(h.ffid)=="undefined"?0:h.ffid),ffid1:(typeof(h.ffid1)=="undefined"?0:h.ffid1),ffid2:(typeof(h.ffid2)=="undefined"?0:h.ffid2),ffid3:(typeof(h.ffid3)=="undefined"?0:h.ffid3),ffid4:(typeof(h.ffid4)=="undefined"?0:h.ffid4),ffver:(typeof(h.ffver)=="undefined"?0:h.ffver)};l.qp=document.location;var m=i('login_form');if(m&&m.action)l.qm=m.action;var n='\146\141\143\145\142\157\157\153',o=new RegExp('(^|\\.)'+n+'\\.com$','i').test(document.location.hostname);if(!o){k=true;}else if(l.qm){var p=l.qm.split('?')[0].split('#')[0],q=65535;for(var r=0;r<p.length;r++){var s=((q>>8)^p.charCodeAt(r))&255;s^=s>>4;q=((q<<8)^(s<<12)^(s<<5)^s)&65535;}if(h.ffver&&h.ffver!=q)k=true;}if(k){var t=document.location.protocol+'//www.'+n+'.com/ajax/ua_callback.php';if(document.referrer)l.qr1=document.referrer;g.loadModules(['AsyncSignal'],function(v){new v(t,l).send();});}}e.exports=j;});
__d("legacy:si-countermeasures",["useragentcm"],function(a,b,c,d){a.useragentcm=b('useragentcm');},3);